<html>

<head>
    <title>Underbangs</title>
    <link rel="stylesheet" type="text/css" href="flex.css">
    <link rel="stylesheet" type="text/css" href="index.css">
    <script type="text/javascript" src="vue.min.js"></script>
    <script type="text/javascript" src="index.js"></script>
</head>

<body onload="init()">
    <div id="ribody" class="flxp-rcs">
        <div id="divLoadingStage" class="flxp-ccs section">
            <div id="divClientPort" class="flxp-ccs loading-stage"
                :class="{ focus: loadingStage === 'spawn-client' }">
                <input type="text" id="txtClientName" class="txt txt-center"
                    ondblclick="this.value += 'k'"
                    value="Jack" />
                <input type="text" id="txtClientPort" class="txt txt-center"
                    ondblclick="this.value = parseInt(this.value) - 1"
                    value="9487" />
                <span id="btnSpawn" class="btn flxc" 
                    onclick="spawnclient(txtClientPort.value, txtClientName.value)">
                    Spawn</span>
            </div>
            <div v-if="spawned" id="divWelcome" class="flxp-ccs loading-stage"
                :class="{ focus: loadingStage === 'join-game' }">
                <input type="text" id="txtJoinURL" class="txt txt-center"
                    value="http://127.0.0.1:9488" />
                <span id="btnJoin" class="btn flxc" 
                    onclick="joingame(txtJoinURL.value)">
                    Join</span>
                <span style="text-align: center">OR</span>
                <input type="text" id="txtServerPort" class="txt txt-center" value="9488" />
                <span id="btnHost" class="btn flxc"
                    onclick="hostgame(txtServerPort.value)">
                    Host</span>
            </div>
            <div v-if="ingame" id="divGameRound" class="flxc flxp-css loading-stage"
                :class="{ focus: loadingStage === 'in-game' }">
                <div class="flxc flxp-css">
                    <span class="stage__title" readonly>{{stage(client.game.stage)}}</span>
                    <div v-if="client.game.stage === 'ask'" class="flxp-ccs">
                        <span class="lbl">You are asking </span>
                        <div>
                            <span class="player__number bandaid"
                                >#{{client.game.questionto}}</span>
                            <span class="player__name flxc"
                                >{{client.game.players[client.game.questionto].name}}</span>
                        </div>
                        <span class="lbl">Question</span>
                        <input type="text" id="txtAskQuestion" class="txt"
                            placeholder="Question" />
                        <span class="lbl">Reference Link</span>
                        <input type="text" id="txtAskLink" class="txt"
                            placeholder="Reference Link" />
                        <span class="lbl">Image Link</span>
                        <input type="text" id="txtAskImage" class="txt"
                            onchange="setBGI(imgAskImagePreview, this.value)"
                            placeholder="Image Link" />
                        <div class="flxp-rcc">
                            <span id="imgAskImagePreview" class="player__img"></span>
                        </div>
                        <span class="btn" onclick="ask()">Ask!</span>
                    </div>
                    <div v-if="client.game.stage === 'round'" class="flxc flxp-ccc">
                        <div class="flxp-rcc" style="justify-content: flex-start;">
                            <span class="lbl">Now, it's</span>
                        </div>
                        <div class="flxp-rcc">
                            <span class="player__number bandaid"
                                >#{{client.game.round}}</span>
                            <span class="player__name flxc"
                                >{{client.game.players[client.game.round].name}}</span>
                        </div>
                        <div class="flxp-rcc" style="justify-content: flex-end;">
                            <span class="lbl">'s turn!</span>
                        </div>
                        <span class="player__img"
                            :style=" { 'background-image': `url(${questionOf(client.game.round).image})` } "></span>
                        <span class="player__question lbl"
                            :title="questionOf(client.game.round).link"
                            onclick="openLinkInBrowser(this.title)"
                            >{{questionOf(client.game.round).question}}</span>
                        <textarea class="flxc txt player__note"
                            :readonly="client.game.round !== client.game.menumber"
                            :value="client.game.questions[client.game.round].note"
                            v-model="client.game.questions[client.game.round].note"
                            onchange="vm.client.updateNote(this.value)"
                            placeholder="You can take some note here. "></textarea>
                    </div>
                </div>
                <div v-if="ishost" id="divHostControls" class="flxp-rcc">
                    <span id="btnGameRoundNext" class="btn flxc"
                        v-on:click="client.controlServerNext()">Next</span>
                    <span id="btnGameRoundEnd" class="btn flxc">End</span>
                    <span id="btnGameRoundRestart" class="btn flxc">Restart</span>
                </div>
            </div>
        </div>
        <div id="divField" class="flxc flxp-ccs">
            <div v-if="spawned" id="divPlayers" class="flxc">
                <div v-for="player in client.game.players" class="player flxp-rcs">
                    <div class="flxc flxp-ccs">
                        <div class="flxp-rsc">
                            <span class="player__number bandaid"
                                :title="`Player No.${player.number}`">
                                #{{player.number}}
                            </span>
                            <span class="player__name flxc">{{player.name}}</span>
                        </div>
                        <div v-if="player.number !== client.game.menumber"
                            class="flxp-rsc">
                            <span class="player__question lbl"
                                :title="questionOf(player.number).link"
                                onclick="openLinkInBrowser(this.title)"
                                >{{questionOf(player.number).question}}</span>
                        </div>
                        <textarea class="flxc txt player__note" 
                            :readonly="player.url !== client.me.url"
                            onchange="vm.client.updateNote(this.value)"
                            placeholder="You can take some note here. "
                            :value="client.game.questions[player.number].note"
                            v-model="client.game.questions[player.number].note"
                            ></textarea>
                    </div>
                    <span class="player__img"
                        :style=" { 'background-image': `url(${questionOf(player.number).image})` } "
                        onclick="toggleBigImage(this)"></span>
                </div>
            </div>
        </div>
    </div>
</body>

</html>